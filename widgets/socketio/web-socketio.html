<link rel="import" href="../../bower_components/polymer/polymer.html">

<script>
  Web_SocketIO_Behavior = {
    created: function() {
      this.isYbWeb = true;
      this._socketio;
      this._onInitWeb = new Set();
    },
    setSocketio: function(socketio) {
      var self = this;
      self._socketio = socketio;
      
      require(['core/web-socketio'], function(WebSocketIO) {
        self.ybWeb = WebSocketIO.Client(socketio);
        
        if (self.ybWeb.isSeeded()) {
          self._notifyInitWeb(self.ybWeb);
        } else {
          self.ybWeb.onSeed(function() {
            self._notifyInitWeb(self.ybWeb);
          });
        }
      });
    },
    onInitWeb: function(callback) {
      if (this.ybWeb && this.ybWeb.isSeeded()) {
        callback(this.ybWeb);
      } else {
        this._onInitWeb.add(callback);
      }
    },
    _notifyInitWeb: function(web) {
      this._onInitWeb.forEach(function(callback) {
        callback(web);
      });
      this._onInitWeb.clear();
    },
  }
</script>

<dom-module id="yb-web-socketio">

  <script>
    (function() {
      'use strict';
      behaviors: [Web_SocketIO_Behavior],
      Polymer({
        is: 'yb-web-socketio',

      });
    })();
  </script>
  
</dom-module>