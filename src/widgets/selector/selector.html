<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">

<link rel="import" href="selector-styles.html">

<dom-module id="yb-selector">

  <style include="selector-styles"></style>

  <template>
    <template is="dom-if" if="{{nodeId}}">
      <paper-button id="clearButton" on-tap="clear">
        <iron-icon icon="icons:clear"></iron-icon>
      </paper-button>
    </template>
  </template>
  
  <script>
    (function() {
      'use strict';
      
      Polymer({
        is: 'yb-selector',
        properties: {
          'nodeId': {
            type: String,
            observer: 'nodeIdChanged',
            notify: true,
          },
        },
        ready: function() {
          this.classList.toggle('is-empty', this.nodeId ? false : true);
        
          if (this.nodeId) {
            this.nodeWidget = document.createElement('yb-node');
            this.nodeWidget.nodeId = this.nodeId;
            Polymer.dom(this.root).insertBefore(this.nodeWidget, Polymer.dom(this.root).firstChild);
          } else {
            this.nodeWidget = null;
          }
        },
        nodeIdChanged: function() {
        
          this.classList.toggle('is-empty', this.nodeId ? false : true);
          
          if (this.nodeWidget) {
            this.fire('nodeWidgetDestroyed', this.nodeWidget);
            Polymer.dom(this.root).removeChild(this.nodeWidget);
          }
          if (this.nodeId) {
            this.nodeWidget = document.createElement('yb-node');
            this.nodeWidget.nodeId = this.nodeId;
            Polymer.dom(this.root).insertBefore(this.nodeWidget, Polymer.dom(this.root).firstChild);
          }
          
          this.fire('nodeIdChanged', this.nodeId);
        },
        clear: function() {
          this.set('nodeId', null);
        }
      });
    })();
  </script>

</dom-module>